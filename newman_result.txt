newman

userapi tests order pay

â†’ create user 1
  POST http://arch.homework/otusapp/nryzhkov/api/v1/user  
  503 Service Temporarily Unavailable â˜… 22ms time â˜… 425Bâ†‘ 345Bâ†“ size â˜… 9â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†‘ raw â˜… 118B
  â”‚ {"login":"n19398Eo9zV","email":"19398jC2Au@mail.ru","p
  â”‚ assword":"12345678","first_name":"Nikita","last_name":
  â”‚ "Ryzhkov"}
  â”” 
  â”Œ â†“ text/html â˜… text â˜… html â˜… utf8 â˜… 190B
  â”‚ <html>
  â”‚ <head><title>503 Service Temporarily Unavailable</titl
  â”‚ e></head>
  â”‚ <body>
  â”‚ <center><h1>503 Service Temporarily Unavailable</h1></
  â”‚ center>
  â”‚ <hr><center>nginx</center>
  â”‚ </body>
  â”‚ </html>
  â””
  prepare   wait   dns-lookup   tcp-handshake   transfer-start   download   process   total 
  10ms      6ms    3ms          494Âµs           5ms              5ms        114Âµs     32ms  

  1. Response status code is 201
  2. Response body contains user ID
  3. Empty wallet
  4â „ JSONError in test-script

â†’ authorize user 1
  POST http://arch.homework/otusapp/nryzhkov/api/v1/login  
  500 Internal Server Error â˜… 34ms time â˜… 357Bâ†‘ 427Bâ†“ size â˜… 9â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†‘ raw â˜… 50B
  â”‚ {
  â”‚     "username": "",
  â”‚     "password": "12345678"
  â”‚ }
  â”” 
  â”Œ â†“ application/json â˜… text â˜… json â˜… utf8 â˜… 260B
  â”‚ {"error":"failed to get user by login: failed to get u
  â”‚ ser info: failed to get user info by http and login : 
  â”‚ Get \"http://userapp-service.default.svc.cluster.local
  â”‚ :8000/internal/api/v1/user/by_login/\": dial tcp 10.96
  â”‚ .193.123:8000: connect: connection refused"}
  â””
  prepare   wait    dns-lookup   tcp-handshake   transfer-start   download   process   total 
  882Âµs     251Âµs   (cache)      (cache)         32ms             1ms        36Âµs      34ms  

  5. Response status code is 200
  âœ“  Response body contains user ID

â†’ billing money/credit
  POST http://arch.homework/otusapp/nryzhkov/api/v1/billing/money/credit  
  503 Service Temporarily Unavailable â˜… 4ms time â˜… 390Bâ†‘ 345Bâ†“ size â˜… 10â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†‘ raw â˜… 40B
  â”‚ {
  â”‚     "user_id": 0,
  â”‚     "amount": 1000
  â”‚ }
  â”” 
  â”Œ â†“ text/html â˜… text â˜… html â˜… utf8 â˜… 190B
  â”‚ <html>
  â”‚ <head><title>503 Service Temporarily Unavailable</titl
  â”‚ e></head>
  â”‚ <body>
  â”‚ <center><h1>503 Service Temporarily Unavailable</h1></
  â”‚ center>
  â”‚ <hr><center>nginx</center>
  â”‚ </body>
  â”‚ </html>
  â””
  prepare   wait    dns-lookup   tcp-handshake   transfer-start   download   process   total 
  604Âµs     121Âµs   (cache)      (cache)         2ms              642Âµs      20Âµs      3ms   

  6. Empty wallet

â†’ create order
  POST http://arch.homework/otusapp/nryzhkov/api/v1/order/create  
  503 Service Temporarily Unavailable â˜… 2ms time â˜… 385Bâ†‘ 345Bâ†“ size â˜… 10â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†‘ raw â˜… 43B
  â”‚ {
  â”‚     "item": "pencil1",
  â”‚     "price": 150
  â”‚ }
  â”” 
  â”Œ â†“ text/html â˜… text â˜… html â˜… utf8 â˜… 190B
  â”‚ <html>
  â”‚ <head><title>503 Service Temporarily Unavailable</titl
  â”‚ e></head>
  â”‚ <body>
  â”‚ <center><h1>503 Service Temporarily Unavailable</h1></
  â”‚ center>
  â”‚ <hr><center>nginx</center>
  â”‚ </body>
  â”‚ </html>
  â””
  prepare   wait    dns-lookup   tcp-handshake   transfer-start   download   process   total 
  573Âµs     118Âµs   (cache)      (cache)         1ms              587Âµs      20Âµs      2ms   

  7. Response status code is 201

â†’ get user 1
  GET http://arch.homework/otusapp/nryzhkov/api/v1/user/0  
  503 Service Temporarily Unavailable â˜… 6ms time â˜… 283Bâ†‘ 345Bâ†“ size â˜… 8â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†“ text/html â˜… text â˜… html â˜… utf8 â˜… 190B
  â”‚ <html>
  â”‚ <head><title>503 Service Temporarily Unavailable</titl
  â”‚ e></head>
  â”‚ <body>
  â”‚ <center><h1>503 Service Temporarily Unavailable</h1></
  â”‚ center>
  â”‚ <hr><center>nginx</center>
  â”‚ </body>
  â”‚ </html>
  â””
  prepare   wait    dns-lookup   tcp-handshake   transfer-start   download   process   total 
  2ms       417Âµs   (cache)      (cache)         3ms              1ms        86Âµs      8ms   

  8. Response status code is 200
  9. Money are withdrawn

â†’ notifications
  GET http://arch.homework/otusapp/nryzhkov/api/v1/notification/list  
  503 Service Temporarily Unavailable â˜… 5ms time â˜… 294Bâ†‘ 345Bâ†“ size â˜… 8â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†“ text/html â˜… text â˜… html â˜… utf8 â˜… 190B
  â”‚ <html>
  â”‚ <head><title>503 Service Temporarily Unavailable</titl
  â”‚ e></head>
  â”‚ <body>
  â”‚ <center><h1>503 Service Temporarily Unavailable</h1></
  â”‚ center>
  â”‚ <hr><center>nginx</center>
  â”‚ </body>
  â”‚ </html>
  â””
  prepare   wait    dns-lookup   tcp-handshake   transfer-start   download   process   total 
  1ms       273Âµs   (cache)      (cache)         2ms              1ms        45Âµs      5ms   

 10. Money are withdrawn

â†’ create expensive order
  POST http://arch.homework/otusapp/nryzhkov/api/v1/order/create  
  503 Service Temporarily Unavailable â˜… 4ms time â˜… 387Bâ†‘ 345Bâ†“ size â˜… 10â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†‘ raw â˜… 45B
  â”‚ {
  â”‚     "item": "pencil1",
  â”‚     "price": 10000
  â”‚ }
  â”” 
  â”Œ â†“ text/html â˜… text â˜… html â˜… utf8 â˜… 190B
  â”‚ <html>
  â”‚ <head><title>503 Service Temporarily Unavailable</titl
  â”‚ e></head>
  â”‚ <body>
  â”‚ <center><h1>503 Service Temporarily Unavailable</h1></
  â”‚ center>
  â”‚ <hr><center>nginx</center>
  â”‚ </body>
  â”‚ </html>
  â””
  prepare   wait    dns-lookup   tcp-handshake   transfer-start   download   process   total 
  858Âµs     193Âµs   (cache)      (cache)         1ms              864Âµs      30Âµs      3ms   

 11. Response status code is 201

â†’ get user 2
  GET http://arch.homework/otusapp/nryzhkov/api/v1/user/0  
  503 Service Temporarily Unavailable â˜… 6ms time â˜… 283Bâ†‘ 345Bâ†“ size â˜… 8â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†“ text/html â˜… text â˜… html â˜… utf8 â˜… 190B
  â”‚ <html>
  â”‚ <head><title>503 Service Temporarily Unavailable</titl
  â”‚ e></head>
  â”‚ <body>
  â”‚ <center><h1>503 Service Temporarily Unavailable</h1></
  â”‚ center>
  â”‚ <hr><center>nginx</center>
  â”‚ </body>
  â”‚ </html>
  â””
  prepare   wait    dns-lookup   tcp-handshake   transfer-start   download   process   total 
  1ms       500Âµs   (cache)      (cache)         3ms              1ms        52Âµs      7ms   

 12. Response status code is 200
 13. Money are withdrawn

â†’ notifications 2
  GET http://arch.homework/otusapp/nryzhkov/api/v1/notification/list  
  503 Service Temporarily Unavailable â˜… 4ms time â˜… 294Bâ†‘ 345Bâ†“ size â˜… 8â†‘ 4â†“ headers â˜… 0 cookies
  â”Œ â†“ text/html â˜… text â˜… html â˜… utf8 â˜… 190B
  â”‚ <html>
  â”‚ <head><title>503 Service Temporarily Unavailable</titl
  â”‚ e></head>
  â”‚ <body>
  â”‚ <center><h1>503 Service Temporarily Unavailable</h1></
  â”‚ center>
  â”‚ <hr><center>nginx</center>
  â”‚ </body>
  â”‚ </html>
  â””
  prepare   wait    dns-lookup   tcp-handshake   transfer-start   download   process   total 
  1ms       318Âµs   (cache)      (cache)         2ms              1ms        38Âµs      5ms   

 14. Money are withdrawn

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚         executed â”‚           failed â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              iterations â”‚                1 â”‚                0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                requests â”‚                9 â”‚                0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            test-scripts â”‚               18 â”‚                1 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      prerequest-scripts â”‚               11 â”‚                0 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              assertions â”‚               14 â”‚               13 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ total run duration: 6.2s                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ total data received: 1.78kB (approx)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ average response time: 9ms [min: 2ms, max: 34ms, s.d.: 10ms]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ average DNS lookup time: 3ms [min: 3ms, max: 3ms, s.d.: 0Âµs]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ average first byte time: 6ms [min: 1ms, max: 32ms, s.d.: 9ms] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

[31m   # [39m[31m failure        [39m[31m detail                                                [39m
[90m     [39m[90m                [39m[90m                                                       [39m
 01.  AssertionError  Response status code is 201                           
                      expected response to have status code 201 but got 503 
                      at assertion:0 in test-script                         
                      inside "create user 1"                                
[90m     [39m[90m                [39m[90m                                                       [39m
 02.  JSONError       Response body contains user ID                        
                      Unexpected token '<' at 1:1                           
                      <html>                                                
                      ^                                                     
                      at assertion:1 in test-script                         
                      inside "create user 1"                                
[90m     [39m[90m                [39m[90m                                                       [39m
 03.  JSONError       Empty wallet                                          
                      Unexpected token '<' at 1:1                           
                      <html>                                                
                      ^                                                     
                      at assertion:2 in test-script                         
                      inside "create user 1"                                
[90m     [39m[90m                [39m[90m                                                       [39m
 04.  JSONError                                                             
                      Unexpected token '<' at 1:1                           
                      <html>                                                
                      ^                                                     
                      at test-script                                        
                      inside "create user 1"                                
[90m     [39m[90m                [39m[90m                                                       [39m
 05.  AssertionError  Response status code is 200                           
                      expected response to have status code 200 but got 500 
                      at assertion:0 in test-script                         
                      inside "authorize user 1"                             
[90m     [39m[90m                [39m[90m                                                       [39m
 06.  JSONError       Empty wallet                                          
                      Unexpected token '<' at 1:1                           
                      <html>                                                
                      ^                                                     
                      at assertion:0 in test-script                         
                      inside "billing money/credit"                         
[90m     [39m[90m                [39m[90m                                                       [39m
 07.  AssertionError  Response status code is 201                           
                      expected response to have status code 201 but got 503 
                      at assertion:0 in test-script                         
                      inside "create order"                                 
[90m     [39m[90m                [39m[90m                                                       [39m
 08.  AssertionError  Response status code is 200                           
                      expected 503 to equal 200                             
                      at assertion:0 in test-script                         
                      inside "get user 1"                                   
[90m     [39m[90m                [39m[90m                                                       [39m
 09.  JSONError       Money are withdrawn                                   
                      Unexpected token '<' at 1:1                           
                      <html>                                                
                      ^                                                     
                      at assertion:1 in test-script                         
                      inside "get user 1"                                   
[90m     [39m[90m                [39m[90m                                                       [39m
 10.  JSONError       Money are withdrawn                                   
                      Unexpected token '<' at 1:1                           
                      <html>                                                
                      ^                                                     
                      at assertion:0 in test-script                         
                      inside "notifications"                                
[90m     [39m[90m                [39m[90m                                                       [39m
 11.  AssertionError  Response status code is 201                           
                      expected response to have status code 201 but got 503 
                      at assertion:0 in test-script                         
                      inside "create expensive order"                       
[90m     [39m[90m                [39m[90m                                                       [39m
 12.  AssertionError  Response status code is 200                           
                      expected 503 to equal 200                             
                      at assertion:0 in test-script                         
                      inside "get user 2"                                   
[90m     [39m[90m                [39m[90m                                                       [39m
 13.  JSONError       Money are withdrawn                                   
                      Unexpected token '<' at 1:1                           
                      <html>                                                
                      ^                                                     
                      at assertion:1 in test-script                         
                      inside "get user 2"                                   
[90m     [39m[90m                [39m[90m                                                       [39m
 14.  JSONError       Money are withdrawn                                   
                      Unexpected token '<' at 1:1                           
                      <html>                                                
                      ^                                                     
                      at assertion:0 in test-script                         
                      inside "notifications 2"                              
